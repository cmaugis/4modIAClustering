<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4modIA-Clustering - TP 1 - Kmeans et ses variantes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./LogoINSAToulouse.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">4modIA-Clustering</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./TP1-Kmeans-SujetEtudiant.html" rel="" target="">
 <span class="menu-text">TP1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TP2-DBSCAN-SujetEtudiant.html" rel="" target="">
 <span class="menu-text">TP2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TP3-CAH-SujetEtudiant.html" rel="" target="">
 <span class="menu-text">TP3</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TP4-MelangesGMM-SujetEtudiant.html" rel="" target="">
 <span class="menu-text">TP4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TP5-Velib-SujetEtudiant.html" rel="" target="">
 <span class="menu-text">TP5</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#clustering-des-données-de-vins-quantitatives" id="toc-clustering-des-données-de-vins-quantitatives" class="nav-link active" data-scroll-target="#clustering-des-données-de-vins-quantitatives"><span class="header-section-number">1</span> Clustering des données de vins (quantitatives)</a>
  <ul class="collapse">
  <li><a href="#analyse-descriptive-des-données" id="toc-analyse-descriptive-des-données" class="nav-link" data-scroll-target="#analyse-descriptive-des-données"><span class="header-section-number">1.1</span> Analyse descriptive des données</a></li>
  <li><a href="#classification-avec-lalgorithme-des-kmeans" id="toc-classification-avec-lalgorithme-des-kmeans" class="nav-link" data-scroll-target="#classification-avec-lalgorithme-des-kmeans"><span class="header-section-number">1.2</span> Classification avec l’algorithme des Kmeans</a></li>
  <li><a href="#classification-avec-lalgorithme-pam" id="toc-classification-avec-lalgorithme-pam" class="nav-link" data-scroll-target="#classification-avec-lalgorithme-pam"><span class="header-section-number">1.3</span> Classification avec l’algorithme PAM</a></li>
  <li><a href="#classification-avec-lalgorithme-fuzzy-c-means" id="toc-classification-avec-lalgorithme-fuzzy-c-means" class="nav-link" data-scroll-target="#classification-avec-lalgorithme-fuzzy-c-means"><span class="header-section-number">1.4</span> Classification avec l’algorithme fuzzy c-means</a></li>
  </ul></li>
  <li><a href="#clustering-des-données-zoo" id="toc-clustering-des-données-zoo" class="nav-link" data-scroll-target="#clustering-des-données-zoo"><span class="header-section-number">2</span> Clustering des données Zoo</a>
  <ul class="collapse">
  <li><a href="#statistiques-descriptives-1" id="toc-statistiques-descriptives-1" class="nav-link" data-scroll-target="#statistiques-descriptives-1"><span class="header-section-number">2.1</span> Statistiques descriptives</a></li>
  <li><a href="#fonctions-auxiliaires-pour-la-suite" id="toc-fonctions-auxiliaires-pour-la-suite" class="nav-link" data-scroll-target="#fonctions-auxiliaires-pour-la-suite"><span class="header-section-number">2.2</span> Fonctions auxiliaires pour la suite</a></li>
  <li><a href="#clustering-à-laide-des-kmodes" id="toc-clustering-à-laide-des-kmodes" class="nav-link" data-scroll-target="#clustering-à-laide-des-kmodes"><span class="header-section-number">2.3</span> Clustering à l’aide des Kmodes</a></li>
  <li><a href="#clustering-avec-les-kmeans-sur-les-coordonnées-de-acm" id="toc-clustering-avec-les-kmeans-sur-les-coordonnées-de-acm" class="nav-link" data-scroll-target="#clustering-avec-les-kmeans-sur-les-coordonnées-de-acm"><span class="header-section-number">2.4</span> Clustering avec les Kmeans sur les coordonnées de ACM</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP 1 - Kmeans et ses variantes</h1>
<p class="subtitle lead">Correction - 2025/2026</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>L’objectif de ce TP est d’illustrer les notions abordées dans le chapitre dédié aux algorithmes de clustering de type Kmeans. Les librairies R nécessaires pour ce TP :</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-1_15915e3eff47965e0c6646c4a6ad5fc1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppclust)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#library(circlize)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#library(viridis)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="clustering-des-données-de-vins-quantitatives" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Clustering des données de vins (quantitatives)</h1>
<section id="analyse-descriptive-des-données" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="analyse-descriptive-des-données"><span class="header-section-number">1.1</span> Analyse descriptive des données</h2>
<section id="présentation-des-données-de-vins" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="présentation-des-données-de-vins"><span class="header-section-number">1.1.1</span> Présentation des données de vins</h3>
<p>Dans ce TP, on va utiliser le jeu de données <code>wine</code> disponible sur la page moodle du cours.</p>
<p>Ce jeu de données comprend des mesures physico-chimiques réalisées sur un échantillon de <span class="math inline">\(n=600\)</span> vins (rouges et blancs) du Portugal. Ces mesures sont complétées par une évaluation sensorielle de la qualité par un ensemble d’experts. Chaque vin est décrit par les variables suivantes :</p>
<ul>
<li>Qualite : son évaluation sensorielle par les experts (“bad”,“medium”,“good”),</li>
<li>Type : son type (1 pour un vin rouge, 0 pour un vin blanc),</li>
<li>AcidVol : la teneur en acide volatile (en g/dm3 d’acide acétique),</li>
<li>AcidCitr : la teneur en acide citrique (en g/dm3),</li>
<li>SO2lbr : le dosage du dioxyde de soufre libre (en mg/dm3),</li>
<li>SO2tot : le dosage du dioxyde de soufre total (en mg/dm3),</li>
<li>Densite : la densité (en g/cm3),</li>
<li>Alcool : le degré d’alcool (en % Vol.).</li>
</ul>
<p><strong>Question 1.</strong> Récupérez sur moodle le jeu de données <code>wine.txt</code> et chargez-le sous R.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-2_e8717ccbfd766b6c49bcfd1f4f1f9f96">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span><span class="fu">read.table</span>(.......)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vérifiez la nature des variables à l’aide de la fonction <code>str()</code>. Modifiez si nécessaire les variables qualitatives (à l’aide de <code>as.factor()</code>) et transformez les modalités “1” et “0” de la variable <code>Type</code>en “rouge” et “blanc” respectivement (à l’aide de la fonction <code>factor()</code>).</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-3_2b68a25cc525e4f16b51bf1a4149c956">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>Qualite <span class="ot">&lt;-</span> ....</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(....)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-4_940330645e0660b80dc7ab5384df0136">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>wine<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"wine.txt"</span>,<span class="at">header=</span>T)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   600 obs. of  8 variables:
 $ Qualite : chr  "medium" "medium" "medium" "medium" ...
 $ Type    : int  1 0 0 0 0 1 0 0 0 0 ...
 $ AcidVol : num  0.62 0.34 0.22 0.35 0.42 0.48 0.21 0.28 0.3 0.4 ...
 $ AcidCitr: num  0.01 0.1 0.22 0.46 0.32 0.32 0.32 0.14 0.25 0.42 ...
 $ SO2lbr  : num  8 17 39 61 20 21 39 64 21 41 ...
 $ SO2tot  : int  46 63 110 183 167 122 113 159 124 176 ...
 $ Densite : num  0.993 0.994 0.999 0.998 0.995 ...
 $ Alcool  : num  11.8 9.2 9 9 10.6 9.4 10.2 10 10.8 9.4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>Qualite <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(wine<span class="sc">$</span>Qualite)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(wine<span class="sc">$</span>Type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"blanc"</span>, <span class="st">"rouge"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 600   8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Qualite  Type AcidVol AcidCitr SO2lbr SO2tot Densite Alcool
1352  medium rouge    0.62     0.01      8     46 0.99332   11.8
5493  medium blanc    0.34     0.10     17     63 0.99370    9.2
5153  medium blanc    0.22     0.22     39    110 0.99855    9.0
5308  medium blanc    0.35     0.46     61    183 0.99786    9.0
3866  medium blanc    0.42     0.32     20    167 0.99479   10.6
694   medium rouge    0.48     0.32     21    122 0.99840    9.4</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="statistiques-descriptives" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="statistiques-descriptives"><span class="header-section-number">1.1.2</span> Statistiques descriptives</h3>
<p><strong>Question 2.</strong> Faites quelques statistiques descriptives pour faire connaissance avec le jeu de données, avec des choix adaptés à la nature des variables. En particulier, étudiez les corrélations entre les variables quantitatives et faites une ACP.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-5_01d08155f9d7edf03004c5008c1a323e">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A completer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-6_1dc3f035fbc32f18eaca0215487a924e">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Qualite       Type        AcidVol          AcidCitr          SO2lbr      
 bad   : 19   blanc:425   Min.   :0.1000   Min.   :0.0000   Min.   :  2.00  
 good  :110   rouge:175   1st Qu.:0.2400   1st Qu.:0.2400   1st Qu.: 15.75  
 medium:471               Median :0.3000   Median :0.3000   Median : 27.00  
                          Mean   :0.3512   Mean   :0.3141   Mean   : 29.41  
                          3rd Qu.:0.4300   3rd Qu.:0.3900   3rd Qu.: 41.00  
                          Max.   :1.0400   Max.   :1.0000   Max.   :112.00  
     SO2tot         Densite           Alcool     
 Min.   :  7.0   Min.   :0.9875   Min.   : 8.00  
 1st Qu.: 68.0   1st Qu.:0.9925   1st Qu.: 9.50  
 Median :114.5   Median :0.9949   Median :10.40  
 Mean   :111.2   Mean   :0.9947   Mean   :10.49  
 3rd Qu.:154.0   3rd Qu.:0.9970   3rd Qu.:11.30  
 Max.   :278.0   Max.   :1.0030   Max.   :14.00  </code></pre>
</div>
</div>
<p>On trace les barplots pour les variables qualitatives</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-7_4e04804fac563cb623f5550f143e08a5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wine) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> Type, <span class="at">y =</span> ..prop.., <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>Qualite_rec <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(wine<span class="sc">$</span>Qualite, <span class="st">"bad"</span>, <span class="st">"medium"</span>, <span class="st">"good"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wine) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> Qualite_rec, <span class="at">y =</span> ..prop.., <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequences"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Qualite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>wine<span class="ot">&lt;-</span>wine[,<span class="sc">-</span><span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On trace les violin-plots pour chacune des variables quantitatives :</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-8_7574f8527b5f2028356a7efb8b0d6505">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(wine[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)]),<span class="fu">aes</span>(<span class="at">x=</span>variable,<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(wine[,<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>)]),<span class="fu">aes</span>(<span class="at">x=</span>variable,<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">variable=</span><span class="fu">rep</span>(<span class="st">"Densite"</span>,<span class="fu">nrow</span>(wine)),<span class="at">value=</span>wine<span class="sc">$</span>Densite),<span class="fu">aes</span>(<span class="at">x=</span>variable,<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On peut regarder également les corrélations entre variables quantitatives :</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-9_7ab12b135bc325ba093096f54da63e56">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]),<span class="at">method=</span><span class="st">"ellipse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ACP pour visualiser les données :</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-10_7edcfe418ada39e13b2732a57a01e8eb">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>resacp<span class="ot">&lt;-</span><span class="fu">PCA</span>(wine,<span class="at">quali.sup=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">scale.unit =</span> <span class="cn">TRUE</span>,<span class="at">graph=</span><span class="cn">FALSE</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des valeurs propres</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(resacp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des variables</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection des individus</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage=</span>wine<span class="sc">$</span>Type,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage=</span>wine<span class="sc">$</span>Type,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Pour la suite, on va utiliser les variables quantitatives pour faire de la classification non supervisée des vins. Les variables <em>Qualite</em> et <em>Type</em> seront utilisées comme des variables extérieures pour comparer / croiser avec les classifications obtenues pour l’interprétation.</p>
<p>Pensez-vous qu’il est nécessaire de transformer les variables quantitatives dans l’objectif de clustering avec un algorithme des Kmeans ? Si oui, mettez en place cette transformation.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-11_9829ff9106fcea405ac415ac54e41c08">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A completer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<p>En raison des différences d’échelle entre les différentes variables, on va centrer-réduire les données.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-12_37bd00b3735c5ee6d90ef763e4d87ee6">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wineinit<span class="ot">&lt;-</span>wine</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]<span class="ot">&lt;-</span><span class="fu">scale</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">center=</span>T,<span class="at">scale=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="classification-avec-lalgorithme-des-kmeans" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="classification-avec-lalgorithme-des-kmeans"><span class="header-section-number">1.2</span> Classification avec l’algorithme des Kmeans</h2>
<section id="a-k3-fixé" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="a-k3-fixé"><span class="header-section-number">1.2.1</span> A K=3 fixé</h3>
<p><strong>Question :</strong> A l’aide de la fonction <code>kmeans()</code>, faites une classification non supervisée en 3 classes des vins. Regardez les options disponibles dans la fonction <code>kmeans()</code>.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-13_d3340ace17734dfef8b4c77dc1c72ce1">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(kmeans)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>reskmeans<span class="ot">&lt;-</span><span class="fu">kmeans</span>(....)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-14_4792db46c1563482c188337674216936">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>reskmeans<span class="ot">&lt;-</span><span class="fu">kmeans</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">centers=</span>K)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Question :</strong> Combien a-ton de vins par classe ? Visualisez la classification obtenue dans les premiers plans de l’ACP (vous pouvez utiliser la fonction <code>PCA()</code> de la librairie <code>FactoMineR</code> et la fonction <code>fviz_cluster</code> de la librairie <code>factoextra</code>).</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-15_3206e1f51609ca06e6854cdba118c575">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-16_3b68f9ef32b6b16bcd202b5efd337ee1">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(reskmeans<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
170 182 248 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(reskmeans,<span class="at">data=</span>wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">ellipse.type=</span><span class="st">"norm"</span>,<span class="at">labelsize=</span><span class="dv">8</span>,<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">col.ind=</span><span class="fu">as.factor</span>(reskmeans<span class="sc">$</span>cluster),</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">col.ind=</span><span class="fu">as.factor</span>(reskmeans<span class="sc">$</span>cluster),</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">col.ind=</span><span class="fu">as.factor</span>(reskmeans<span class="sc">$</span>cluster),</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-16-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> La classification obtenue précédemment a-t-elle un lien avec le type de vins ? Avec la qualité du vin ? Vous pouvez vous aider de la fonction <code>table()</code>, la fonction <code>adjustedRandIndex()</code> de la librairie <code>mclust</code>, …</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-17_92315eb97ab2bec827ec5d009cea85c7">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-18_9d7b70eb88874302b15a1164b4de2372">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(reskmeans<span class="sc">$</span>cluster,wine<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    blanc rouge
  1    21   149
  2   173     9
  3   231    17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(reskmeans<span class="sc">$</span>cluster,wine<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3552072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(reskmeans<span class="sc">$</span>cluster,wine<span class="sc">$</span>Qualite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    bad good medium
  1   7   15    148
  2   4   21    157
  3   8   74    166</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(reskmeans<span class="sc">$</span>cluster,wine<span class="sc">$</span>Qualite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.001572137</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="choix-du-nombre-de-classes" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="choix-du-nombre-de-classes"><span class="header-section-number">1.2.2</span> Choix du nombre de classes</h3>
<p><strong>Question :</strong> On s’intéresse dans cette section au choix du nombre de classes <span class="math inline">\(K\)</span> en étudiant l’évolution de l’inertie intraclasse. En faisant varier <span class="math inline">\(K\)</span> entre 2 et 15, calculez l’inertie intraclasse associée à chaque classification obtenue. Tracez l’évolution de l’inertie intraclasse en fonction du nombre de classes. Qu’en concluez-vous ?</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-19_b7abbccc04022ba724a4a359f3881ae0">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A completer</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Kmax<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>reskmeanscl<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(wine),<span class="at">ncol=</span>Kmax<span class="dv">-1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>Iintra<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  resaux<span class="ot">&lt;-</span><span class="fu">kmeans</span>(...)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  reskmeanscl[,k<span class="dv">-1</span>]<span class="ot">&lt;-</span>resaux<span class="sc">$</span>...</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  Iintra<span class="ot">&lt;-</span><span class="fu">c</span>(Iintra,resaux<span class="sc">$</span>...)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">Iintra=</span>Iintra)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Iintra))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Nombre de classes"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Inertie intraclasse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-20_9cc7f248295515bf0bdad3d2d2bf3317">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Kmax<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>reskmeanscl<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(wine),<span class="at">ncol=</span>Kmax<span class="dv">-1</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>Iintra<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  resaux<span class="ot">&lt;-</span><span class="fu">kmeans</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],<span class="at">centers=</span>k)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  reskmeanscl[,k<span class="dv">-1</span>]<span class="ot">&lt;-</span>resaux<span class="sc">$</span>cluster</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  Iintra<span class="ot">&lt;-</span><span class="fu">c</span>(Iintra,resaux<span class="sc">$</span>tot.withinss)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">Iintra=</span>Iintra)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Iintra))<span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Nombre de classes"</span>)<span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Inertie intraclasse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Reprendre la question du choix du nombre de classes en utilisant le critère silhouette (vous pouvez vous aider de la fonction <code>silhouette()</code> de la librairie <code>cluster</code>). Pour la classification sélectionnée, représentez les poids <span class="math inline">\(s(i)\)</span> de chaque individu à l’aide de la fonction <code>fviz_silhouette()</code>.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-21_3259521bf235cce17c53d555214801fe">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Silhou<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>   aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(..., <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>   Silhou<span class="ot">&lt;-</span><span class="fu">c</span>(Silhou,<span class="fu">mean</span>(aux[,<span class="dv">3</span>]))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span>Kmax,<span class="at">Silhouette=</span>Silhou)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Silhouette))<span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(...)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(aux)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">9</span>))</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df,Silhou,aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-22_7ef3d2100a95d61027f9124a57b63e23">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Silhou<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>   aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(reskmeanscl[,k<span class="dv">-1</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>   Silhou<span class="ot">&lt;-</span><span class="fu">c</span>(Silhou,<span class="fu">mean</span>(aux[,<span class="dv">3</span>]))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span>Kmax,<span class="at">Silhouette=</span>Silhou)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Silhouette))<span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(reskmeanscl[,<span class="dv">3</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(aux)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1  218          0.33
2       2  168          0.29
3       3  114          0.29
4       4  100          0.18</code></pre>
</div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-23_c66ecaedc662a72e0bfff366595db438">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df,Silhou,aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="classification-avec-lalgorithme-pam" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="classification-avec-lalgorithme-pam"><span class="header-section-number">1.3</span> Classification avec l’algorithme PAM</h2>
<p><strong>Question :</strong> Déterminez une classification en <span class="math inline">\(K=3\)</span> classes des vins en utilisant la méthode PAM (fonction <code>pam()</code>de la librairie <code>cluster</code>) et représentez graphiquement la classification obtenue. A-t-elle un lien avec le type de vins ? Avec la qualité ? Avec la classification en <span class="math inline">\(K=3\)</span> classes obtenue avec la méthode des Kmeans?</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-24_c4a69682ffb480a5e8dfc0af16fbc97f">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>resPAM<span class="ot">&lt;-</span><span class="fu">pam</span>(<span class="at">x=</span>....,<span class="at">k=</span>..,<span class="at">metric=</span>...)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>resPAM<span class="sc">$</span>medoids</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>resPAM<span class="sc">$</span>id.med</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(resPAM,<span class="at">data=</span>wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">ellipse.type=</span><span class="st">"norm"</span>,<span class="at">labelsize=</span><span class="dv">8</span>,<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">""</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">col.ind=</span><span class="fu">as.factor</span>(resPAM<span class="sc">$</span>clustering),<span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(......)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(.......)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>clust1<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"K-k"</span>,......,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>clust2<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"PAM-k"</span>,......,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>Tab<span class="ot">&lt;-</span><span class="fu">melt</span>(<span class="fu">table</span>(clust1,clust2))</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Tab,<span class="fu">aes</span>(<span class="at">y=</span>value,<span class="at">axis1=</span>clust1,<span class="at">axis2=</span>clust2))<span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill=</span>clust1))<span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)<span class="sc">+</span>   </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)))<span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-25_4e693cf8132c6352ec5beffd3a85597d">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>resPAM<span class="ot">&lt;-</span><span class="fu">pam</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dv">3</span>, <span class="at">metric =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>resPAM<span class="sc">$</span>medoids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        AcidVol    AcidCitr      SO2lbr     SO2tot    Densite     Alcool
1394  1.0289792 -0.40602926 -0.58761623 -0.9282763  0.4927485 -0.2492357
1604 -0.7392533  0.03737243  0.99240181  1.3323390  0.3148856 -0.5107428
2155 -0.6173062  0.16405862  0.08953436 -0.3230722 -1.0532900  0.7096239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>resPAM<span class="sc">$</span>id.med</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 562 316  22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(resPAM,<span class="at">data=</span>wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">ellipse.type=</span><span class="st">"norm"</span>,<span class="at">labelsize=</span><span class="dv">8</span>,<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">col.ind=</span><span class="fu">as.factor</span>(resPAM<span class="sc">$</span>clustering),<span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(resPAM<span class="sc">$</span>clustering,wine<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3553001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resPAM<span class="sc">$</span>clustering,wine<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    blanc rouge
  1    34   163
  2   177     1
  3   214    11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(resPAM<span class="sc">$</span>clustering,wine<span class="sc">$</span>Qualite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01383852</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resPAM<span class="sc">$</span>clustering,wine<span class="sc">$</span>Qualite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    bad good medium
  1  11   15    171
  2   4   23    151
  3   4   72    149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(resPAM<span class="sc">$</span>clustering,reskmeans<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7990222</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resPAM<span class="sc">$</span>clustering,reskmeans<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      1   2   3
  1 170  11  16
  2   0 167  11
  3   0   4 221</code></pre>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-26_e105bf78f683f77025559b4dcb4f0107">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>clust1<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"K-k"</span>,reskmeanscl[,<span class="dv">2</span>],<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>clust2<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"PAM-k"</span>,resPAM<span class="sc">$</span>clustering,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>Tab<span class="ot">&lt;-</span><span class="fu">melt</span>(<span class="fu">table</span>(clust1,clust2))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Tab,<span class="fu">aes</span>(<span class="at">y=</span>value,<span class="at">axis1=</span>clust1,<span class="at">axis2=</span>clust2))<span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill=</span>clust1))<span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)<span class="sc">+</span>   </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)))<span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-27_439c4399c2db61c5345b4c917632bf08">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(resPAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Question :</strong> Déterminez le nombre de classes optimal par le critère Silhouette pour <span class="math inline">\(K\)</span> variant entre 2 et 15 avec l’algorithme PAM. Commentez la classification retenue. Est-elle proche de celle obtenue avec l’algorithme des Kmeans ?</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-28_95b4f48b253c0f6b9a8f6bf6d0813733">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A completer</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>Kmax<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>resPAMcl<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(wine),<span class="at">ncol=</span>Kmax<span class="dv">-1</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>Silhou<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  resaux<span class="ot">&lt;-</span><span class="fu">pam</span>(.....)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  resPAMcl[,k<span class="dv">-1</span>]<span class="ot">&lt;-</span>resaux<span class="sc">$</span>clustering</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(resPAMcl[,k<span class="dv">-1</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  Silhou<span class="ot">&lt;-</span><span class="fu">c</span>(Silhou,......)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span>Kmax,<span class="at">Silhouette=</span>Silhou)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Silhouette))<span class="sc">+</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(resPAMcl[,<span class="dv">1</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]))</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(aux)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">9</span>))</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(.....)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(.....)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-29_b89dfc2f7e510467e633fdbdeb848cc1">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Kmax<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>resPAMcl<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(wine),<span class="at">ncol=</span>Kmax<span class="dv">-1</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>Silhou<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax){</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  resaux<span class="ot">&lt;-</span><span class="fu">pam</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],k,<span class="at">metric=</span><span class="st">"euclidean"</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  resPAMcl[,k<span class="dv">-1</span>]<span class="ot">&lt;-</span>resaux<span class="sc">$</span>clustering</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(resPAMcl[,k<span class="dv">-1</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  Silhou<span class="ot">&lt;-</span><span class="fu">c</span>(Silhou,<span class="fu">mean</span>(aux[,<span class="dv">3</span>]))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">K=</span><span class="dv">2</span><span class="sc">:</span>Kmax,<span class="at">Silhouette=</span>Silhou)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Silhouette))<span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">&lt;-</span><span class="fu">silhouette</span>(resPAMcl[,<span class="dv">1</span>], <span class="fu">daisy</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(aux)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1  203          0.23
2       2  397          0.28</code></pre>
</div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(resPAMcl[,<span class="dv">1</span>],reskmeanscl[,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.358877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resPAMcl[,<span class="dv">1</span>],reskmeanscl[,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      1   2   3   4
  1  13   3 114  73
  2 205 165   0  27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resPAMcl[,<span class="dv">1</span>],wine<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    blanc rouge
  1    37   166
  2   388     9</code></pre>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-30_1a5eb90a20b7052ee868fb1b872da764">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>clust1<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"K-k"</span>,reskmeanscl[,<span class="dv">3</span>],<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>clust2<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"PAM-k"</span>,resPAMcl[,<span class="dv">1</span>],<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>Tab<span class="ot">&lt;-</span><span class="fu">melt</span>(<span class="fu">table</span>(clust1,clust2))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Tab,<span class="fu">aes</span>(<span class="at">y=</span>value,<span class="at">axis1=</span>clust1,<span class="at">axis2=</span>clust2))<span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill=</span>clust1))<span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)<span class="sc">+</span>   </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)))<span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="classification-avec-lalgorithme-fuzzy-c-means" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="classification-avec-lalgorithme-fuzzy-c-means"><span class="header-section-number">1.4</span> Classification avec l’algorithme fuzzy c-means</h2>
<section id="présentation" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="présentation"><span class="header-section-number">1.4.1</span> Présentation</h3>
<p>Avec les algorithmes de clustering précédents (Kmeans, PAM) nous obtenons une classification “dure” au sens que chaque individu ne peut appartenir qu’à une seule classe et chaque individu participe avec le même poids à la construction des classes. Une classification dure <span class="math inline">\(\mathcal{P}_K=\{\mathcal{C}_1,\ldots,\mathcal{C}_K\}\)</span> peut se traduire en une matrice <span class="math inline">\(Z=(z_{ik})_{\underset{1\leq k \leq K}{1\leq i \leq n}}\)</span> avec <span class="math inline">\(z_{ik}=1\)</span> si <span class="math inline">\(i\in\mathcal{C}_k\)</span> et 0 sinon. Dans cette section, nous allons nous intéresser à une adaptation de l’algorithme des Kmeans, appelée <em>fuzzy c-means</em>. L’idée est de retourner une classification <em>fuzzy</em> c’est-à-dire une matrice <span class="math inline">\(W=(\omega_{ik})_{\underset{1\leq k \leq K}{1\leq i \leq n}}\)</span> avec <span class="math inline">\(\forall i,\ k,\ \omega_{ik}\geq 0\)</span> et <span class="math inline">\(\forall i,\ \underset{k=1}{\stackrel{K}{\sum}} \omega_{ik}=1\)</span>. On donne ainsi plutôt un poids <span class="math inline">\(\omega_{ik}\)</span> que l’individu <span class="math inline">\(i\)</span> appartienne à la classe <span class="math inline">\(\mathcal{C}_k\)</span>.</p>
<p>L’algorithme fuzzy c-means a pour fonction objective</p>
<p><span class="math display">\[
\underset{W,\{m_1,\ldots,m_K\}}{\mbox{argmin}}\ \underset{i=1}{\stackrel{n}{\sum}}\underset{k=1}{\stackrel{K}{\sum}} (\omega_{ik})^\gamma\ \|x_i - m_k\|^2
\]</span> où <span class="math inline">\(X=(x_1,\ldots,x_n)'\)</span> est la matrice des données, <span class="math inline">\(\gamma\in[1,+\infty[\)</span>, <span class="math inline">\(m_k\)</span> est le centre de la classe <span class="math inline">\(\mathcal{C}_k\)</span>.</p>
<p>Dans le même principe que l’algorithme des Kmeans, l’algorithme fuzzy c-means est un algorithme itératif :</p>
<ul>
<li>Step 1: Initialisation des poids <span class="math inline">\(W^{(0)}\)</span></li>
<li>Step 2: A l’itération <span class="math inline">\(r\)</span>, on calcule les centres des classes</li>
</ul>
<p><span class="math display">\[
m_k^{(r)} = \frac{\underset{i=1}{\stackrel{n}{\sum}} (\omega_{ik}^{(r-1)})^\gamma x_i}{\underset{i=1}{\stackrel{n}{\sum}} (\omega_{ik}^{(r-1)})^\gamma}
\]</span></p>
<ul>
<li><p>Step 3: Mise à jour des poids (<span class="math inline">\(\gamma&gt;1\)</span>) <span class="math display">\[
\omega_{ik}^{(r)} = \left[\underset{\ell=1}{\stackrel{K}{\sum}} \left(\frac{\|x_i - m_k^{(r)}\|^2}{\|x_i - m_\ell^{(r)}\|^2}\right)^{\frac{1}{\gamma-1}}  \right]^{-1}
\]</span></p></li>
<li><p>Step 4: Si <span class="math inline">\(\|W^{(r)} - W^{(r-1)}\|&lt;\)</span> seuil, on s’arrête, sinon on retourne à l’étape 2.</p></li>
</ul>
<p>En général, la puissance choisie sur les poids est <span class="math inline">\(\gamma=2\)</span>. Dans le cas <span class="math inline">\(\gamma=1\)</span>, on retrouve l’algorithme des Kmeans.</p>
</section>
<section id="application-avec-r" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="application-avec-r"><span class="header-section-number">1.4.2</span> Application avec R</h3>
<p>Nous allons ici nous appuyer sur la fonction <code>fcm()</code> de la librairie <code>ppclust</code>.</p>
<p><strong>Question :</strong> Utilisez cet algorithme pour obtenir une classification en <span class="math inline">\(3\)</span> classes. Comment sont initialisés les poids ? Comment est obtenue la classification finale ? A l’aide des poids, étudiez la stabilité des classes. Vous pouvez pour cela étudier les poids des individus par classe.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-31_b26ad099a2409952cc98a6878cf160ed">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppclust)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>resfcm<span class="ot">&lt;-</span><span class="fu">fcm</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-32_e2951badcfbb7cd4f9b7e5574ddddf47">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppclust)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>resfcm<span class="ot">&lt;-</span><span class="fu">fcm</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">centers=</span> <span class="dv">3</span>, <span class="at">m=</span><span class="dv">2</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">apply</span>(resfcm<span class="sc">$</span>u,<span class="dv">1</span>,which.max))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
230 175 195 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(resfcm<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
230 175 195 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Aux<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">cluster=</span><span class="fu">as.factor</span>(resfcm<span class="sc">$</span>cluster),<span class="at">PoidsMax=</span><span class="fu">apply</span>(resfcm<span class="sc">$</span>u,<span class="dv">1</span>,max))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Aux,<span class="fu">aes</span>(<span class="at">x=</span>cluster,<span class="at">y=</span>PoidsMax))<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Représentez la classification obtenue sur le premier plan de l’ACP en nuançant selon les poids.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-33_be92409e2f29d1346da1989481226d33">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">col.ind=</span><span class="fu">apply</span>(....................))<span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">mid=</span><span class="st">"blue"</span>,<span class="at">high=</span><span class="st">"red"</span>, <span class="at">midpoint=</span><span class="fl">0.8</span>, <span class="at">space =</span> <span class="st">"Lab"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-34_079307b8a3485bc30081965ff6dd2d07">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">habillage=</span><span class="fu">as.factor</span>(resfcm<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(resacp,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>),<span class="at">col.ind=</span><span class="fu">apply</span>(resfcm<span class="sc">$</span>u,<span class="dv">1</span>,max))<span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">mid=</span><span class="st">"blue"</span>,<span class="at">high=</span><span class="st">"red"</span>, <span class="at">midpoint=</span><span class="fl">0.8</span>, <span class="at">space =</span> <span class="st">"Lab"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question</strong> : Comparez les classifications obtenues avec Kmeans et fuzzy c-means. Commentez.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-35_c20d32675094d8e4987973dc24fd5be8">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-36_6ce4573bcec57b354a8557f05950dbcb">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>reskmeans<span class="ot">&lt;-</span><span class="fu">kmeans</span>(wine[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="dv">3</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(reskmeans<span class="sc">$</span>cluster,resfcm<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8800417</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(reskmeans<span class="sc">$</span>cluster,resfcm<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      1   2   3
  1 228   9  11
  2   0   0 182
  3   2 166   2</code></pre>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-37_1f9fe80a8703c2bb92b144a6031305bd">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(viridis)</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>clust1F<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"Cl1-K"</span>,reskmeans<span class="sc">$</span>cluster,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>clust2F<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"Cl2-K"</span>,resfcm<span class="sc">$</span>cluster,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Tab&lt;-melt(table(clust1F,clust2F))</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">#mycolor &lt;- viridis(6, alpha = 1, begin = 0, end = 1, option = "H")</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">#mycolor &lt;- mycolor[sample(1:6)]</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(<span class="fu">table</span>(clust2F,clust1F)) <span class="co">#,grid.col=mycolor)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="clustering-des-données-zoo" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Clustering des données Zoo</h1>
<p>Dans cette partie, on souhaite obtenir une classification d’animaux d’un zoo en fonction de plusieurs caractéristiques. Ces 16 variables sont qualitatives (majoritairement binaires).</p>
<section id="statistiques-descriptives-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="statistiques-descriptives-1"><span class="header-section-number">2.1</span> Statistiques descriptives</h2>
<p><strong>Question :</strong> Commencez par charger le jeu de données <code>zoo-dataTP.txt</code> et faites quelques statistiques descriptives pour vous familiariser avec ce jeu de données.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-38_f3960ecb07c6179087573902b9162480">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>zoo<span class="ot">&lt;-</span> ...</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-39_146eaaa9d3ce55241b9db1ccac3f1a6a">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace de construction des données</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>zoo<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"zoo.data"</span>,<span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(zoo))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  zoo[,j]<span class="ot">&lt;-</span><span class="fu">as.factor</span>(zoo[,j])</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>zoo[<span class="dv">27</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"frog1"</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(zoo)<span class="ot">&lt;-</span> zoo[,<span class="dv">1</span>]</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>type<span class="ot">&lt;-</span>zoo[,<span class="dv">18</span>]</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>zoo<span class="ot">&lt;-</span>zoo[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">18</span>)]</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(zoo)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"hair"</span>,<span class="st">"feathers"</span>,<span class="st">"eggs"</span>,<span class="st">"milk"</span>,<span class="st">"airbone"</span>,<span class="st">"aquatic"</span>,<span class="st">"predator"</span>,<span class="st">"toothed"</span>,<span class="st">"backbone"</span>,<span class="st">"breathes"</span>,<span class="st">"venomous"</span>,<span class="st">"fins"</span>,<span class="st">"legs"</span>,<span class="st">"tail"</span>,<span class="st">"domestic"</span>,<span class="st">"catsize"</span>)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(zoo,<span class="at">file=</span><span class="st">"zoo-dataTP.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-40_9b31a80978b2ebf1fa46bccef33f6675">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>zoo<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"zoo-dataTP.txt"</span>,<span class="at">header=</span>T,<span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(zoo))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  zoo[,j]<span class="ot">&lt;-</span><span class="fu">as.factor</span>(zoo[,j])</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> hair   feathers eggs   milk   airbone aquatic predator toothed backbone
 0:58   0:81     0:42   0:60   0:77    0:65    0:45     0:40    0:18    
 1:43   1:20     1:59   1:41   1:24    1:36    1:56     1:61    1:83    
                                                                        
                                                                        
                                                                        
                                                                        
 breathes venomous fins   legs   tail   domestic catsize
 0:21     0:93     0:84   0:23   0:26   0:88     0:57   
 1:80     1: 8     1:17   2:27   1:75   1:13     1:44   
                          4:38                          
                          5: 1                          
                          6:10                          
                          8: 2                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101  16</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Faites une analyse en composantes multiples de ce jeu de données.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-41_77850678be3e576c6ea2cc3ffdc2124c">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>res.mca<span class="ot">&lt;-</span><span class="fu">MCA</span>(....)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-42_f913ca2ab337bd143fe7c3f0231ef8a9">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>res.mca<span class="ot">&lt;-</span> <span class="fu">MCA</span>(zoo,<span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(res.mca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(res.mca, invisible = c("quali.sup", "ind"), cex=1, col.var = "darkblue", cex.main=2, col.main= "darkblue")</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca,<span class="at">col.ind=</span><span class="st">"darkblue"</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res.mca,<span class="at">col.var=</span><span class="st">"darkblue"</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-42-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res.mca, <span class="at">choice =</span> <span class="st">"mca.cor"</span>, </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-42-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-43_a5399dbb7206139e539b9fee369e1124">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Contrib des variables</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.mca, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.mca, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-44_241f84c5583e28383912d995f4621a73">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">### plot of individuals </span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca,  <span class="at">habillage=</span><span class="dv">4</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca,  <span class="at">habillage=</span><span class="dv">3</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca,  <span class="at">habillage=</span><span class="dv">12</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca,  <span class="at">habillage=</span><span class="dv">13</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-44-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="fonctions-auxiliaires-pour-la-suite" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="fonctions-auxiliaires-pour-la-suite"><span class="header-section-number">2.2</span> Fonctions auxiliaires pour la suite</h2>
<p>Pour la suite du TP, on pourra utiliser les fonctions auxiliaires suivantes. La fonction <code>barplotClus()</code> permet de tracer la répartition des modalités de variables qualitatives pour chaque classe d’un clustering donné.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-45_119f82034c36212819ae93de6b0ac197">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># J indice des variables</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Data = jeu de données</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># clust = clustering étudié</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># output : liste des graphes par variable dans J donnant la répartition des modalités de J par classe de clust</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>barplotClus <span class="ot">&lt;-</span> <span class="cf">function</span>(clust, Data, J) {</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    aux.long.p <span class="ot">&lt;-</span> <span class="fu">heatm</span>(clust, Data, J)<span class="sc">$</span>freq</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    p<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(J)) {</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>        p[[j]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aux.long.p[<span class="fu">which</span>(aux.long.p<span class="sc">$</span>variable <span class="sc">==</span> <span class="fu">colnames</span>(Data)[J[j]]), ],</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> clust, <span class="at">y =</span> perc, <span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">fill =</span> <span class="fu">colnames</span>(Data)[J[j]])</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>heatm <span class="ot">&lt;-</span> <span class="cf">function</span>(clust, Data, J) {</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>    Dataaux <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id.s =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Data)), Data)</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>    aux <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Dataaux, clust)</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>    aux.long <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">data.frame</span>(<span class="fu">lapply</span>(aux, as.character)), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="fu">c</span>(<span class="st">"id.s"</span>, <span class="st">"clust"</span>), <span class="at">factorsAsStrings =</span> T)</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Effectifs</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>    aux.long.q <span class="ot">&lt;-</span> aux.long <span class="sc">%&gt;%</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(clust, variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">n_distinct</span>(id.s)) <span class="sc">%&gt;%</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>(clust, variable, value, count)</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># avec fréquences</span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>    aux.long.p <span class="ot">&lt;-</span> aux.long.q <span class="sc">%&gt;%</span></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(clust, variable) <span class="sc">%&gt;%</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">perc =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(clust)</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>    Lev <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Data)) Lev <span class="ot">&lt;-</span> <span class="fu">c</span>(Lev, <span class="fu">levels</span>(Data[, j]))</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>    Jaux <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(J)) {</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>        Jaux <span class="ot">&lt;-</span> <span class="fu">c</span>(Jaux, <span class="fu">which</span>(aux.long.p<span class="sc">$</span>variable <span class="sc">==</span> <span class="fu">colnames</span>(Data)[J[j]]))</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>    gaux <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aux.long.p[Jaux, ], <span class="fu">aes</span>(<span class="at">x =</span> clust, <span class="at">y =</span> value)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> perc)) <span class="sc">+</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">mid =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">gaux =</span> gaux, <span class="at">eff =</span> aux.long.q, <span class="at">freq =</span> aux.long.p))</span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clustering-à-laide-des-kmodes" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="clustering-à-laide-des-kmodes"><span class="header-section-number">2.3</span> Clustering à l’aide des Kmodes</h2>
<p>Dans cette partie, nous allons utiliser la méthode des Kmodes introduite par Huang (1998). Rappelons que cette méthode est une extension des Kmeans dans le cas des données qualitatives. Les modifications par rapport aux Kmeans sont</p>
<ul>
<li>le changement de distance : on utilise la dissimilarité basée sur l’appariement simple</li>
</ul>
<p><span class="math display">\[
d(\mathbf{x}_i,\mathbf{x}_\ell) = \underset{j=1}{\stackrel{p}{\sum}}\ \mathbb{1}_{x_{ij}\neq x_{\ell j}}
\]</span></p>
<ul>
<li>le centre d’une classe est calculé en fonction des fréquences des modalités majoritaires présentes dans cette classe: pour la classe <span class="math inline">\(\mathcal{C}_k\)</span>,</li>
</ul>
<p><span class="math display">\[
\mathbf{m}_k=(m_{k1},\ldots,m_{kp}) \textrm{ avec } m_{kj}= \underset{u_1,\ldots,u_{s_j}}{\mbox{argmax}}\ \underset{i\in\mathcal C_k}{\sum}\ \mathbb{1}_{x_{ij}= u_{s_j}}
\]</span></p>
<p><strong>Question :</strong> A l’aide de la fonction <code>kmodes()</code>de la librairie <code>klaR</code>, déterminez une classification en <span class="math inline">\(K=6\)</span> classes des animaux. Visualisez la classification obtenue. Vous pouvez vous aider des fonctions auxiliaires pour interpréter la classification.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-46_3d3e5202821c8aef66bf313ab2f0e1bd">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>reskmodes<span class="ot">&lt;-</span><span class="fu">kmodes</span>(....)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-47_db725ca14ce83afc820760d686e352b1">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>clkmodes <span class="ot">&lt;-</span> <span class="fu">kmodes</span>(zoo, K, <span class="at">iter.max =</span> <span class="dv">100</span>, <span class="at">weight =</span> <span class="cn">FALSE</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clkmodes<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6 
19 19 20 20  4 19 </code></pre>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-48_8a798858ef6a7a4273799f036c48d150">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>clkmodes<span class="sc">$</span>modes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  hair feathers eggs milk airbone aquatic predator toothed backbone breathes
1    0        0    1    0       0       0        0       0        0        1
2    1        0    0    1       0       0        1       1        1        1
3    1        0    0    1       0       0        0       1        1        1
4    0        1    1    0       1       0        0       0        1        1
5    0        0    0    1       0       1        1       1        1        1
6    0        0    1    0       0       1        1       1        1        0
  venomous fins legs tail domestic catsize
1        0    0    6    0        0       0
2        0    0    4    1        0       1
3        0    0    4    1        0       1
4        0    0    2    1        0       0
5        0    1    0    1        0       1
6        0    1    0    1        0       0</code></pre>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-49_f907c75fb9048f72f485b818b5953d78">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mca, <span class="at">habillage =</span> <span class="fu">as.factor</span>(clkmodes<span class="sc">$</span>cluster), <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>,<span class="st">"text"</span>),<span class="at">repel=</span>T) <span class="sc">+</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Kmodes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-50_82ea85224ab5bcd8c61ee0686066bc7c">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">barplotClus</span>(clkmodes<span class="sc">$</span>cluster, zoo, <span class="at">J =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs=</span>p,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(p)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">barplotClus</span>(clkmodes<span class="sc">$</span>cluster, zoo, <span class="at">J =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs=</span>p,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(p)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">barplotClus</span>(clkmodes<span class="sc">$</span>cluster, zoo, <span class="at">J =</span> <span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs=</span>p,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-50-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(p)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">barplotClus</span>(clkmodes<span class="sc">$</span>cluster, zoo, <span class="at">J =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>))</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs=</span>p,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-50-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-51_9ec1a567fd028893c899dace26654008">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">cl=</span><span class="fu">as.factor</span>(clkmodes<span class="sc">$</span>cluster),zoo)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>res.mcab<span class="ot">&lt;-</span> <span class="fu">MCA</span>(df,<span class="at">quali.sup=</span><span class="dv">1</span>,<span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res.mcab,<span class="at">col.ind=</span><span class="st">"darkblue"</span>,<span class="at">repel=</span>T,<span class="at">habillage=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res.mcab,<span class="at">col.var=</span><span class="st">"darkblue"</span>,<span class="at">repel=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Pour déterminer le nombre de classes, la méthode du coude peut être utilisée en remplaçant l’inertie intra-classe par le critère “Within Cluster Difference”</p>
<p><span class="math display">\[
WCD(K) = \underset{k=1}{\stackrel{K}{\sum}} \underset{i\in\mathcal C_k}{\sum}\ d(x_i,m_k)  
\]</span></p>
<p>où <span class="math inline">\(d(.,.)\)</span> est l’appariement simple et <span class="math inline">\(m_k\)</span> est le centre de la classe <span class="math inline">\(\mathcal C_k\)</span>.</p>
<p>Tracez la courbe <span class="math inline">\(K\mapsto WCD(K)\)</span> pour déterminer le nombre de classes optimal. Vous pouvez vous aider des sorties de la fonction <code>kmodes()</code>.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-52_fbf6eeec403819cab51df2b15005bd45">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>WithinDiff<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>Kmax<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>Clust<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(zoo),<span class="at">ncol=</span>Kmax)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Kmax){</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">&lt;-</span><span class="fu">kmodes</span>(.........)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  WithinDiff<span class="ot">&lt;-</span><span class="fu">c</span>(WithinDiff,..........)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  Clust[,k]<span class="ot">&lt;-</span>aux<span class="sc">$</span>cluster</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>auxdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">NbCluster=</span><span class="dv">1</span><span class="sc">:</span>Kmax,<span class="at">WithinDiff=</span>WithinDiff)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(auxdf,<span class="fu">aes</span>(<span class="at">x=</span>NbCluster,<span class="at">y=</span>WithinDiff))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-53_26b2360e35a30f1d0ccc2314404cd7f9">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>WithinDiff <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Kmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>Clust <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(zoo), <span class="at">ncol =</span> Kmax)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Kmax) {</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    aux <span class="ot">&lt;-</span> <span class="fu">kmodes</span>(zoo, k, <span class="at">iter.max =</span> <span class="dv">100</span>, <span class="at">weight =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    WithinDiff <span class="ot">&lt;-</span> <span class="fu">c</span>(WithinDiff, <span class="fu">sum</span>(aux<span class="sc">$</span>withindiff))</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    Clust[, k] <span class="ot">&lt;-</span> aux<span class="sc">$</span>cluster</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>auxdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NbCluster =</span> <span class="dv">1</span><span class="sc">:</span>Kmax, <span class="at">WithinDiff =</span> WithinDiff)</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(auxdf, <span class="fu">aes</span>(<span class="at">x =</span> NbCluster, <span class="at">y =</span> WithinDiff)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question</strong> Etudiez la classification retenue. On la notera <code>clustkmodes</code> pour la suite</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-54_9cb5dcb152a1f003817297ee336d793d">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>clustkmodes<span class="ot">&lt;-</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-55_e908a3a203fdfd5614f9fd531897d729">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>clustkmodes<span class="ot">&lt;-</span>Clust[,<span class="dv">4</span>]</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clustkmodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>clustkmodes
 1  2  3  4 
22 39 19 21 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  I<span class="ot">&lt;-</span><span class="fu">which</span>(Clust[,<span class="dv">4</span>]<span class="sc">==</span>k)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classe "</span>,k,<span class="at">sep=</span><span class="st">""</span>))</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rownames</span>(zoo)[I])</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Classe 1"
 [1] "bass"     "carp"     "catfish"  "chub"     "dogfish"  "dolphin" 
 [7] "frog"     "frog1"    "haddock"  "herring"  "newt"     "pike"    
[13] "piranha"  "pitviper" "porpoise" "seahorse" "seasnake" "slowworm"
[19] "sole"     "stingray" "tuatara"  "tuna"    
[1] "Classe 2"
 [1] "aardvark" "antelope" "bear"     "boar"     "buffalo"  "calf"    
 [7] "cavy"     "cheetah"  "deer"     "elephant" "fruitbat" "giraffe" 
[13] "girl"     "goat"     "gorilla"  "hamster"  "hare"     "leopard" 
[19] "lion"     "lynx"     "mink"     "mole"     "mongoose" "opossum" 
[25] "oryx"     "platypus" "polecat"  "pony"     "puma"     "pussycat"
[31] "raccoon"  "reindeer" "seal"     "sealion"  "squirrel" "vampire" 
[37] "vole"     "wallaby"  "wolf"    
[1] "Classe 3"
 [1] "clam"     "crab"     "crayfish" "flea"     "gnat"     "honeybee"
 [7] "housefly" "ladybird" "lobster"  "moth"     "octopus"  "scorpion"
[13] "seawasp"  "slug"     "starfish" "termite"  "toad"     "wasp"    
[19] "worm"    
[1] "Classe 4"
 [1] "chicken"  "crow"     "dove"     "duck"     "flamingo" "gull"    
 [7] "hawk"     "kiwi"     "lark"     "ostrich"  "parakeet" "penguin" 
[13] "pheasant" "rhea"     "skimmer"  "skua"     "sparrow"  "swan"    
[19] "tortoise" "vulture"  "wren"    </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="clustering-avec-les-kmeans-sur-les-coordonnées-de-acm" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="clustering-avec-les-kmeans-sur-les-coordonnées-de-acm"><span class="header-section-number">2.4</span> Clustering avec les Kmeans sur les coordonnées de ACM</h2>
<p>Une seconde stratégie est de partir des coordonnées de l’analyse des correspondances multiples (ACM) et d’utiliser un algorithme plus usuel sur données quantitatives. Dans cette section, on va appliquer l’algorithme des Kmeans.</p>
<p><strong>Question :</strong> Appliquez l’algorithme des Kmeans sur les coordonnées de l’ACM. Pour la détermination du nombre de classes, vous pouvez utiliser l’évolution de l’inertie intra-classe et le critère silhouette.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-56_95b3f6ebbb83182e26a41b0d247f67c3">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-57_b30be42d52a7f225f9443b138fd1fa67">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>Kmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>kmeansclus <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(zoo), <span class="at">ncol =</span> (Kmax <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>Iintra <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>Silhou <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Kmax) {</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    resaux <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    kmeansclus[, (k <span class="sc">-</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> resaux<span class="sc">$</span>cluster</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    Iintra <span class="ot">&lt;-</span> <span class="fu">c</span>(Iintra, resaux<span class="sc">$</span>tot.withinss)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    aux <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(resaux<span class="sc">$</span>cluster, <span class="fu">daisy</span>(res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord))</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    Silhou <span class="ot">&lt;-</span> <span class="fu">c</span>(Silhou, <span class="fu">mean</span>(aux[, <span class="dv">3</span>]))</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> <span class="dv">2</span><span class="sc">:</span>Kmax, <span class="at">Iintra =</span> Iintra, <span class="at">Silhou =</span> Silhou)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> Iintra)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Nombre de classes"</span>) <span class="sc">+</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Inertie intraclasse"</span>)</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> Silhou)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Nombre de classes"</span>) <span class="sc">+</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Critère Silhouette"</span>)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Question :</strong> Etudiez la classification retenue. Comparez avec la classification obtenue précédemment avec les Kmodes.</p>
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-58_a6fb587f88f8a653f109692b346447d5">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A COMPLETER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" data-custom-style="correction" title="Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correction
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-hash="TP1-Kmeans-Correction_cache/html/unnamed-chunk-59_4bfa489b8c9510cd18078821d0a00b28">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Comparaison entre 4 et 6 classes pour Kmeans sur MCA</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kmeansclus[,<span class="dv">3</span>],kmeansclus[,<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     1  2  3  4  5  6
  1  1 10  0  0  0  9
  2  0  0 20  0  0  0
  3  3  0  0 18  0  0
  4 19  0  0  0 21  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Comparaison entre Kmeans sur MCA et Kmodes</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kmeansclus[,<span class="dv">3</span>],clustkmodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   clustkmodes
     1  2  3  4
  1  1  0 19  0
  2  0  0  0 20
  3 20  1  0  0
  4  1 38  0  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedRandIndex</span>(kmeansclus[,<span class="dv">3</span>],clustkmodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8918999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>clust1F<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"Cl-Kmeans"</span>,kmeansclus[,<span class="dv">3</span>],<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>clust2F<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">"Cl-Kmodes"</span>,clustkmodes,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(<span class="fu">table</span>(clust2F,clust1F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP1-Kmeans-Correction_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>